<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è¶£å‘³å•è¯æŒ‘æˆ˜èµ› (200è¯ç‰ˆ)</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --primary-color: #FF9F1C;
            --secondary-color: #2EC4B6;
            --accent-color: #FFBF69;
            --bg-color: #E0F7FA;
            --text-color: #2D3436;
        }

        body {
            font-family: 'Comic Sans MS', 'Segoe UI', sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
            color: var(--text-color);
            -webkit-tap-highlight-color: transparent;
        }

        #app {
            width: 90%;
            max-width: 400px;
            background: white;
            border-radius: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            padding: 25px 20px;
            text-align: center;
            position: relative;
            height: 80vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .stage-badge {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--accent-color);
            color: #fff;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            z-index: 10;
        }

        h1 { color: var(--secondary-color); margin: 10px 0; font-size: 1.8rem; }
        h2 { font-size: 2.5rem; margin: 15px 0; color: var(--primary-color); word-wrap: break-word; }
        .emoji { font-size: 6rem; display: block; margin: 10px auto; animation: float 3s ease-in-out infinite; }
        .translation { font-size: 1.4rem; color: #555; margin-bottom: 20px; font-weight: bold; }

        button {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 15px 0;
            font-size: 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            margin: 10px auto;
            box-shadow: 0 6px 0 #239a8e;
            transition: all 0.1s;
            width: 100%;
            display: block;
            font-weight: bold;
        }

        button:active { box-shadow: 0 2px 0 #239a8e; transform: translateY(4px); }

        button.sound-btn {
            background-color: var(--accent-color);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            padding: 0;
            box-shadow: 0 4px 0 #dca35a;
            font-size: 1.5rem;
            margin: 0 auto 15px auto;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .option-btn {
            background-color: #fff;
            color: var(--text-color);
            border: 2px solid #eee;
            box-shadow: 0 4px 0 #ddd;
            margin: 6px 0;
            padding: 10px;
            font-size: 1.1rem;
        }
        .option-btn:active { box-shadow: 0 2px 0 #ccc; transform: translateY(2px); }

        @keyframes float { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-10px); } }
        @keyframes pop { 0% { transform: scale(0.9); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-8px); } 75% { transform: translateX(8px); } }

        .screen { display: none; animation: pop 0.3s ease-out; width: 100%; height: 100%; flex-direction: column; justify-content: center; }
        .screen.active { display: flex; }

        .progress-bar { width: 100%; height: 10px; background: #eee; border-radius: 10px; margin-top: auto; overflow: hidden; }
        .progress-fill { height: 100%; background: var(--primary-color); width: 0%; transition: width 0.3s ease; }

        .correct-anim { background: #dcedc8 !important; border-color: #8bc34a !important; }
        .wrong-anim { background: #ffcdd2 !important; border-color: #e57373 !important; animation: shake 0.4s; }
    </style>
</head>
<body>

<div id="app">
    <div id="stage-indicator" class="stage-badge" style="display:none">ç¬¬ 1 / 4 å…³</div>

    <!-- é¦–é¡µ -->
    <div id="start-screen" class="screen active">
        <h1>è‹±è¯­å¤§æŒ‘æˆ˜</h1>
        <div class="emoji">ğŸŒ</div>
        <p style="font-size:1.1rem; color:#666; margin: 20px 0;">
            æµ·é‡è¯åº“ï¼š200 è¯<br>
            æ¯æ¬¡éšæœºæŠ½å– 20 ä¸ªæŒ‘æˆ˜ï¼
        </p>
        <button onclick="initGame()">å¼€å§‹æŒ‘æˆ˜</button>
    </div>

    <!-- å­¦ä¹ é¡µ -->
    <div id="study-screen" class="screen">
        <div style="flex:1; display:flex; flex-direction:column; justify-content:center;">
            <div class="emoji" id="study-emoji"></div>
            <h2 id="study-word">Word</h2>
            <p class="translation" id="study-trans">ç¿»è¯‘</p>
            <button class="sound-btn" onclick="speakCurrentWord()">ğŸ”Š</button>
        </div>
        <button onclick="nextStudyCard()" id="study-next-btn">è®°ä½äº†</button>
    </div>

    <!-- æµ‹éªŒé¡µ -->
    <div id="quiz-screen" class="screen">
        <p style="font-size:1.2rem; margin-bottom:15px;">è¯·æ‰¾å‡ºï¼š<br><span id="quiz-question" style="font-weight:bold; font-size:1.6rem; color:var(--primary-color)"></span></p>
        <div id="quiz-options"></div>
        <div class="progress-bar"><div class="progress-fill" id="progress"></div></div>
    </div>

    <!-- è¿‡å…³é¡µ -->
    <div id="level-screen" class="screen">
        <div class="emoji">âœ¨</div>
        <h1 id="level-title">å…³å¡å®Œæˆ!</h1>
        <p>ä¼‘æ¯ä¸€ä¸‹ï¼Œå‡†å¤‡ä¸‹ä¸€ç»„</p>
        <button onclick="nextStage()">è¿›å…¥ä¸‹ä¸€å…³</button>
    </div>
    
    <!-- é€šå…³é¡µ -->
    <div id="final-screen" class="screen">
        <div class="emoji">ğŸ†</div>
        <h1>å¤§æ»¡è´¯!</h1>
        <p>ä»Šå¤© 20 ä¸ªå•è¯å…¨éƒ¨æå®šï¼</p>
        <button onclick="location.reload()" style="background-color:var(--primary-color)">å†æ¥ä¸€å±€ (æ–°å•è¯)</button>
    </div>
</div>

<script>
    // --- 200ä¸ªå•è¯çš„å¤§è¯åº“ ---
    const fullVocabulary = [
        // åŠ¨ç‰© (Animals)
        { word: "Cat", trans: "çŒ«", emoji: "ğŸ±" }, { word: "Dog", trans: "ç‹—", emoji: "ğŸ¶" },
        { word: "Elephant", trans: "å¤§è±¡", emoji: "ğŸ˜" }, { word: "Lion", trans: "ç‹®å­", emoji: "ğŸ¦" },
        { word: "Tiger", trans: "è€è™", emoji: "ğŸ¯" }, { word: "Monkey", trans: "çŒ´å­", emoji: "ğŸµ" },
        { word: "Rabbit", trans: "å…”å­", emoji: "ğŸ°" }, { word: "Bear", trans: "ç†Š", emoji: "ğŸ»" },
        { word: "Panda", trans: "ç†ŠçŒ«", emoji: "ğŸ¼" }, { word: "Koala", trans: "è€ƒæ‹‰", emoji: "ğŸ¨" },
        { word: "Pig", trans: "çŒª", emoji: "ğŸ·" }, { word: "Cow", trans: "å¥¶ç‰›", emoji: "ğŸ®" },
        { word: "Sheep", trans: "ç»µç¾Š", emoji: "ğŸ‘" }, { word: "Horse", trans: "é©¬", emoji: "ğŸ´" },
        { word: "Chicken", trans: "é¸¡", emoji: "ğŸ”" }, { word: "Duck", trans: "é¸­å­", emoji: "ğŸ¦†" },
        { word: "Frog", trans: "é’è›™", emoji: "ğŸ¸" }, { word: "Fish", trans: "é±¼", emoji: "ğŸŸ" },
        { word: "Whale", trans: "é²¸é±¼", emoji: "ğŸ³" }, { word: "Dolphin", trans: "æµ·è±š", emoji: "ğŸ¬" },
        { word: "Shark", trans: "é²¨é±¼", emoji: "ğŸ¦ˆ" }, { word: "Octopus", trans: "ç« é±¼", emoji: "ğŸ™" },
        { word: "Crab", trans: "èƒèŸ¹", emoji: "ğŸ¦€" }, { word: "Turtle", trans: "ä¹Œé¾Ÿ", emoji: "ğŸ¢" },
        { word: "Snake", trans: "è›‡", emoji: "ğŸ" }, { word: "Dinosaur", trans: "æé¾™", emoji: "ğŸ¦•" },
        { word: "Mouse", trans: "è€é¼ ", emoji: "ğŸ­" }, { word: "Giraffe", trans: "é•¿é¢ˆé¹¿", emoji: "ğŸ¦’" },
        { word: "Zebra", trans: "æ–‘é©¬", emoji: "ğŸ¦“" }, { word: "Fox", trans: "ç‹ç‹¸", emoji: "ğŸ¦Š" },
        { word: "Wolf", trans: "ç‹¼", emoji: "ğŸº" }, { word: "Butterfly", trans: "è´è¶", emoji: "ğŸ¦‹" },
        { word: "Bee", trans: "èœœèœ‚", emoji: "ğŸ" }, { word: "Ant", trans: "èš‚èš", emoji: "ğŸœ" },
        { word: "Spider", trans: "èœ˜è››", emoji: "ğŸ•·ï¸" }, { word: "Snail", trans: "èœ—ç‰›", emoji: "ğŸŒ" },
        { word: "Owl", trans: "çŒ«å¤´é¹°", emoji: "ğŸ¦‰" }, { word: "Penguin", trans: "ä¼é¹…", emoji: "ğŸ§" },

        // é£Ÿç‰©ä¸é¥®æ–™ (Food & Drink)
        { word: "Apple", trans: "è‹¹æœ", emoji: "ğŸ" }, { word: "Banana", trans: "é¦™è•‰", emoji: "ğŸŒ" },
        { word: "Orange", trans: "æ©™å­", emoji: "ğŸŠ" }, { word: "Grape", trans: "è‘¡è„", emoji: "ğŸ‡" },
        { word: "Watermelon", trans: "è¥¿ç“œ", emoji: "ğŸ‰" }, { word: "Strawberry", trans: "è‰è“", emoji: "ğŸ“" },
        { word: "Peach", trans: "æ¡ƒå­", emoji: "ğŸ‘" }, { word: "Cherry", trans: "æ¨±æ¡ƒ", emoji: "ğŸ’" },
        { word: "Pineapple", trans: "è è", emoji: "ğŸ" }, { word: "Lemon", trans: "æŸ æª¬", emoji: "ğŸ‹" },
        { word: "Carrot", trans: "èƒ¡èåœ", emoji: "ğŸ¥•" }, { word: "Corn", trans: "ç‰ç±³", emoji: "ğŸŒ½" },
        { word: "Tomato", trans: "è¥¿çº¢æŸ¿", emoji: "ğŸ…" }, { word: "Potato", trans: "åœŸè±†", emoji: "ğŸ¥”" },
        { word: "Broccoli", trans: "è¥¿å…°èŠ±", emoji: "ğŸ¥¦" }, { word: "Mushroom", trans: "è˜‘è‡", emoji: "ğŸ„" },
        { word: "Eggplant", trans: "èŒ„å­", emoji: "ğŸ†" }, { word: "Chili", trans: "è¾£æ¤’", emoji: "ğŸŒ¶ï¸" },
        { word: "Bread", trans: "é¢åŒ…", emoji: "ğŸ" }, { word: "Rice", trans: "ç±³é¥­", emoji: "ğŸš" },
        { word: "Noodle", trans: "é¢æ¡", emoji: "ğŸœ" }, { word: "Dumpling", trans: "é¥ºå­", emoji: "ğŸ¥Ÿ" },
        { word: "Meat", trans: "è‚‰", emoji: "ğŸ¥©" }, { word: "Egg", trans: "é¸¡è›‹", emoji: "ğŸ¥š" },
        { word: "Pizza", trans: "æŠ«è¨", emoji: "ğŸ•" }, { word: "Burger", trans: "æ±‰å ¡", emoji: "ğŸ”" },
        { word: "Fries", trans: "è–¯æ¡", emoji: "ğŸŸ" }, { word: "Hot Dog", trans: "çƒ­ç‹—", emoji: "ğŸŒ­" },
        { word: "Sandwich", trans: "ä¸‰æ˜æ²»", emoji: "ğŸ¥ª" }, { word: "Popcorn", trans: "çˆ†ç±³èŠ±", emoji: "ğŸ¿" },
        { word: "Cake", trans: "è›‹ç³•", emoji: "ğŸ°" }, { word: "Cookie", trans: "æ›²å¥‡", emoji: "ğŸª" },
        { word: "Candy", trans: "ç³–æœ", emoji: "ğŸ¬" }, { word: "Chocolate", trans: "å·§å…‹åŠ›", emoji: "ğŸ«" },
        { word: "Ice Cream", trans: "å†°æ·‡æ·‹", emoji: "ğŸ¦" }, { word: "Donut", trans: "ç”œç”œåœˆ", emoji: "ğŸ©" },
        { word: "Water", trans: "æ°´", emoji: "ğŸ’§" }, { word: "Milk", trans: "ç‰›å¥¶", emoji: "ğŸ¥›" },
        { word: "Juice", trans: "æœæ±", emoji: "ğŸ§ƒ" }, { word: "Tea", trans: "èŒ¶", emoji: "ğŸµ" },
        { word: "Coffee", trans: "å’–å•¡", emoji: "â˜•" }, { word: "Honey", trans: "èœ‚èœœ", emoji: "ğŸ¯" },

        // äº¤é€šä¸å»ºç­‘ (Transport & Places)
        { word: "Car", trans: "æ±½è½¦", emoji: "ğŸš—" }, { word: "Bus", trans: "å…¬äº¤è½¦", emoji: "ğŸšŒ" },
        { word: "Taxi", trans: "å‡ºç§Ÿè½¦", emoji: "ğŸš•" }, { word: "Police Car", trans: "è­¦è½¦", emoji: "ğŸš“" },
        { word: "Ambulance", trans: "æ•‘æŠ¤è½¦", emoji: "ğŸš‘" }, { word: "Fire Truck", trans: "æ¶ˆé˜²è½¦", emoji: "ğŸš’" },
        { word: "Bike", trans: "è‡ªè¡Œè½¦", emoji: "ğŸš²" }, { word: "Motorcycle", trans: "æ‘©æ‰˜è½¦", emoji: "ğŸï¸" },
        { word: "Train", trans: "ç«è½¦", emoji: "ğŸš†" }, { word: "Subway", trans: "åœ°é“", emoji: "ğŸš‡" },
        { word: "Airplane", trans: "é£æœº", emoji: "âœˆï¸" }, { word: "Helicopter", trans: "ç›´å‡æœº", emoji: "ğŸš" },
        { word: "Rocket", trans: "ç«ç®­", emoji: "ğŸš€" }, { word: "Boat", trans: "èˆ¹", emoji: "â›µ" },
        { word: "Ship", trans: "è½®èˆ¹", emoji: "ğŸš¢" }, { word: "Truck", trans: "å¡è½¦", emoji: "ğŸšš" },
        { word: "House", trans: "æˆ¿å­", emoji: "ğŸ " }, { word: "School", trans: "å­¦æ ¡", emoji: "ğŸ«" },
        { word: "Hospital", trans: "åŒ»é™¢", emoji: "ğŸ¥" }, { word: "Shop", trans: "å•†åº—", emoji: "ğŸª" },
        { word: "Park", trans: "å…¬å›­", emoji: "â›²" }, { word: "Castle", trans: "åŸå ¡", emoji: "ğŸ°" },

        // è‡ªç„¶ä¸å¤©æ°” (Nature & Weather)
        { word: "Sun", trans: "å¤ªé˜³", emoji: "â˜€ï¸" }, { word: "Moon", trans: "æœˆäº®", emoji: "ğŸŒ™" },
        { word: "Star", trans: "æ˜Ÿæ˜Ÿ", emoji: "â­" }, { word: "Cloud", trans: "äº‘", emoji: "â˜ï¸" },
        { word: "Rain", trans: "é›¨", emoji: "ğŸŒ§ï¸" }, { word: "Snow", trans: "é›ª", emoji: "â„ï¸" },
        { word: "Wind", trans: "é£", emoji: "ğŸŒ¬ï¸" }, { word: "Lightning", trans: "é—ªç”µ", emoji: "âš¡" },
        { word: "Rainbow", trans: "å½©è™¹", emoji: "ğŸŒˆ" }, { word: "Fire", trans: "ç«", emoji: "ğŸ”¥" },
        { word: "Tree", trans: "æ ‘", emoji: "ğŸŒ³" }, { word: "Flower", trans: "èŠ±", emoji: "ğŸŒ¸" },
        { word: "Grass", trans: "è‰", emoji: "ğŸŒ¿" }, { word: "Leaf", trans: "å¶å­", emoji: "ğŸƒ" },
        { word: "Mountain", trans: "å±±", emoji: "â›°ï¸" }, { word: "Ocean", trans: "å¤§æµ·", emoji: "ğŸŒŠ" },
        { word: "Earth", trans: "åœ°çƒ", emoji: "ğŸŒ" }, { word: "Volcano", trans: "ç«å±±", emoji: "ğŸŒ‹" },

        // ç‰©å“ä¸å·¥å…· (Objects)
        { word: "Book", trans: "ä¹¦", emoji: "ğŸ“–" }, { word: "Pen", trans: "é’¢ç¬”", emoji: "ğŸ–Šï¸" },
        { word: "Pencil", trans: "é“…ç¬”", emoji: "âœï¸" }, { word: "Ruler", trans: "å°ºå­", emoji: "ğŸ“" },
        { word: "Eraser", trans: "æ©¡çš®", emoji: "ğŸ§½" }, { word: "Scissors", trans: "å‰ªåˆ€", emoji: "âœ‚ï¸" },
        { word: "Bag", trans: "ä¹¦åŒ…", emoji: "ğŸ’" }, { word: "Computer", trans: "ç”µè„‘", emoji: "ğŸ’»" },
        { word: "Phone", trans: "æ‰‹æœº", emoji: "ğŸ“±" }, { word: "Camera", trans: "ç›¸æœº", emoji: "ğŸ“·" },
        { word: "TV", trans: "ç”µè§†", emoji: "ğŸ“º" }, { word: "Clock", trans: "æ—¶é’Ÿ", emoji: "â°" },
        { word: "Key", trans: "é’¥åŒ™", emoji: "ğŸ”‘" }, { word: "Lock", trans: "é”", emoji: "ğŸ”’" },
        { word: "Box", trans: "ç›’å­", emoji: "ğŸ“¦" }, { word: "Gift", trans: "ç¤¼ç‰©", emoji: "ğŸ" },
        { word: "Balloon", trans: "æ°”çƒ", emoji: "ğŸˆ" }, { word: "Umbrella", trans: "é›¨ä¼", emoji: "â˜‚ï¸" },
        { word: "Glasses", trans: "çœ¼é•œ", emoji: "ğŸ‘“" }, { word: "Bed", trans: "åºŠ", emoji: "ğŸ›ï¸" },
        { word: "Chair", trans: "æ¤…å­", emoji: "ğŸª‘" }, { word: "Table", trans: "æ¡Œå­", emoji: "æ¡Œ" },
        { word: "Door", trans: "é—¨", emoji: "ğŸšª" }, { word: "Window", trans: "çª—æˆ·", emoji: "ğŸªŸ" },
        { word: "Toothbrush", trans: "ç‰™åˆ·", emoji: "ğŸª¥" }, { word: "Soap", trans: "è‚¥çš‚", emoji: "ğŸ§¼" },
        { word: "Money", trans: "é’±", emoji: "ğŸ’°" }, { word: "Map", trans: "åœ°å›¾", emoji: "ğŸ—ºï¸" },

        // èº«ä½“ä¸è¡£æœ (Body & Clothes)
        { word: "Eye", trans: "çœ¼ç›", emoji: "ğŸ‘ï¸" }, { word: "Ear", trans: "è€³æœµ", emoji: "ğŸ‘‚" },
        { word: "Nose", trans: "é¼»å­", emoji: "ğŸ‘ƒ" }, { word: "Mouth", trans: "å˜´å·´", emoji: "ğŸ‘„" },
        { word: "Hand", trans: "æ‰‹", emoji: "âœ‹" }, { word: "Foot", trans: "è„š", emoji: "ğŸ¦¶" },
        { word: "Arm", trans: "æ‰‹è‡‚", emoji: "ğŸ’ª" }, { word: "Leg", trans: "è…¿", emoji: "ğŸ¦µ" },
        { word: "Tooth", trans: "ç‰™é½¿", emoji: "ğŸ¦·" }, { word: "Heart", trans: "å¿ƒ", emoji: "â¤ï¸" },
        { word: "Brain", trans: "å¤§è„‘", emoji: "ğŸ§ " }, { word: "Bone", trans: "éª¨å¤´", emoji: "ğŸ¦´" },
        { word: "T-shirt", trans: "Tæ¤", emoji: "ğŸ‘•" }, { word: "Pants", trans: "è£¤å­", emoji: "ğŸ‘–" },
        { word: "Dress", trans: "è£™å­", emoji: "ğŸ‘—" }, { word: "Coat", trans: "å¤–å¥—", emoji: "ğŸ§¥" },
        { word: "Shoes", trans: "é‹å­", emoji: "ğŸ‘Ÿ" }, { word: "Socks", trans: "è¢œå­", emoji: "ğŸ§¦" },
        { word: "Hat", trans: "å¸½å­", emoji: "ğŸ‘’" }, { word: "Gloves", trans: "æ‰‹å¥—", emoji: "ğŸ§¤" },
        { word: "Scarf", trans: "å›´å·¾", emoji: "ğŸ§£" }, { word: "Ring", trans: "æˆ’æŒ‡", emoji: "ğŸ’" },
        { word: "Crown", trans: "çš‡å† ", emoji: "ğŸ‘‘" },

        // äººç‰©ä¸èŒä¸š (People & Jobs)
        { word: "Boy", trans: "ç”·å­©", emoji: "ğŸ‘¦" }, { word: "Girl", trans: "å¥³å­©", emoji: "ğŸ‘§" },
        { word: "Man", trans: "ç”·äºº", emoji: "ğŸ‘¨" }, { word: "Woman", trans: "å¥³äºº", emoji: "ğŸ‘©" },
        { word: "Baby", trans: "å©´å„¿", emoji: "ğŸ‘¶" }, { word: "Police", trans: "è­¦å¯Ÿ", emoji: "ğŸ‘®" },
        { word: "Doctor", trans: "åŒ»ç”Ÿ", emoji: "ğŸ‘¨â€âš•ï¸" }, { word: "Nurse", trans: "æŠ¤å£«", emoji: "ğŸ‘©â€âš•ï¸" },
        { word: "Teacher", trans: "è€å¸ˆ", emoji: "ğŸ§‘â€ğŸ«" }, { word: "Chef", trans: "å¨å¸ˆ", emoji: "ğŸ‘¨â€ğŸ³" },
        { word: "Farmer", trans: "å†œæ°‘", emoji: "ğŸ‘©â€ğŸŒ¾" }, { word: "Artist", trans: "ç”»å®¶", emoji: "ğŸ¨" },
        { word: "Singer", trans: "æ­Œæ‰‹", emoji: "ğŸ¤" }, { word: "Astronaut", trans: "å®‡èˆªå‘˜", emoji: "ğŸ§‘â€ğŸš€" },
        { word: "King", trans: "å›½ç‹", emoji: "ğŸ¤´" }, { word: "Queen", trans: "å¥³ç‹", emoji: "ğŸ‘¸" },
        { word: "Prince", trans: "ç‹å­", emoji: "ğŸ¤´" }, { word: "Princess", trans: "å…¬ä¸»", emoji: "ğŸ‘¸" },
        { word: "Santa", trans: "åœ£è¯è€äºº", emoji: "ğŸ…" }, { word: "Ghost", trans: "å¹½çµ", emoji: "ğŸ‘»" },
        { word: "Robot", trans: "æœºå™¨äºº", emoji: "ğŸ¤–" }, { word: "Alien", trans: "å¤–æ˜Ÿäºº", emoji: "ğŸ‘½" },

        // è¿åŠ¨ä¸çˆ±å¥½ (Sports & Hobbies)
        { word: "Soccer", trans: "è¶³çƒ", emoji: "âš½" }, { word: "Basketball", trans: "ç¯®çƒ", emoji: "ğŸ€" },
        { word: "Baseball", trans: "æ£’çƒ", emoji: "âš¾" }, { word: "Tennis", trans: "ç½‘çƒ", emoji: "ğŸ¾" },
        { word: "Volleyball", trans: "æ’çƒ", emoji: "ğŸ" }, { word: "Badminton", trans: "ç¾½æ¯›çƒ", emoji: "ğŸ¸" },
        { word: "Ping Pong", trans: "ä¹’ä¹“çƒ", emoji: "ğŸ“" }, { word: "Boxing", trans: "æ‹³å‡»", emoji: "ğŸ¥Š" },
        { word: "Skiing", trans: "æ»‘é›ª", emoji: "ğŸ¿" }, { word: "Skate", trans: "æ»‘å†°", emoji: "â›¸ï¸" },
        { word: "Music", trans: "éŸ³ä¹", emoji: "ğŸµ" }, { word: "Guitar", trans: "å‰ä»–", emoji: "ğŸ¸" },
        { word: "Piano", trans: "é’¢ç´", emoji: "ğŸ¹" }, { word: "Violin", trans: "å°æç´", emoji: "ğŸ»" },
        { word: "Drum", trans: "é¼“", emoji: "ğŸ¥" }, { word: "Game", trans: "æ¸¸æˆ", emoji: "ğŸ®" },

        // é¢œè‰²ä¸å½¢å®¹è¯ (Colors & Adjectives)
        { word: "Red", trans: "çº¢è‰²", emoji: "ğŸ”´" }, { word: "Blue", trans: "è“è‰²", emoji: "ğŸ”µ" },
        { word: "Yellow", trans: "é»„è‰²", emoji: "ğŸŸ¡" }, { word: "Green", trans: "ç»¿è‰²", emoji: "ğŸŸ¢" },
        { word: "Purple", trans: "ç´«è‰²", emoji: "ğŸŸ£" }, { word: "Black", trans: "é»‘è‰²", emoji: "âš«" },
        { word: "White", trans: "ç™½è‰²", emoji: "âšª" }, { word: "Orange", trans: "æ©™è‰²", emoji: "ğŸŸ " },
        { word: "Happy", trans: "å¼€å¿ƒçš„", emoji: "ğŸ˜„" }, { word: "Sad", trans: "ä¼¤å¿ƒçš„", emoji: "ğŸ˜¢" },
        { word: "Angry", trans: "ç”Ÿæ°”çš„", emoji: "ğŸ˜ " }, { word: "Sleepy", trans: "å›°çš„", emoji: "ğŸ˜ª" },
        { word: "Cool", trans: "é…·", emoji: "ğŸ˜" }, { word: "Sick", trans: "ç”Ÿç—…çš„", emoji: "ğŸ¤’" },
        { word: "Hot", trans: "çƒ­", emoji: "ğŸ¥µ" }, { word: "Cold", trans: "å†·", emoji: "ğŸ¥¶" },
        { word: "Love", trans: "çˆ±", emoji: "â¤ï¸" }, { word: "Strong", trans: "å¼ºå£®", emoji: "ğŸ’ª" }
    ];

    // --- æ¸¸æˆçŠ¶æ€å˜é‡ ---
    const WORDS_PER_DAY = 20;
    const WORDS_PER_STAGE = 5;
    const TOTAL_STAGES = 4;

    let dailyWords = [];
    let currentStage = 1;
    let stageWords = [];
    let currentIndex = 0;
    
    function shuffleArray(array) {
        let newArr = [...array];
        for (let i = newArr.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [newArr[i], newArr[j]] = [newArr[j], newArr[i]];
        }
        return newArr;
    }

    // åˆå§‹åŒ–æ¸¸æˆ
    function initGame() {
        const shuffledAll = shuffleArray(fullVocabulary);
        dailyWords = shuffledAll.slice(0, WORDS_PER_DAY);
        currentStage = 1;
        startStage();
    }

    // å¼€å§‹å…³å¡
    function startStage() {
        const start = (currentStage - 1) * WORDS_PER_STAGE;
        const end = start + WORDS_PER_STAGE;
        stageWords = dailyWords.slice(start, end);
        currentIndex = 0;
        
        document.getElementById('stage-indicator').style.display = 'block';
        document.getElementById('stage-indicator').textContent = `ç¬¬ ${currentStage} / ${TOTAL_STAGES} å…³`;
        
        loadStudyCard();
        showScreen('study-screen');
    }

    // å­¦ä¹ é€»è¾‘
    function loadStudyCard() {
        const item = stageWords[currentIndex];
        document.getElementById('study-emoji').textContent = item.emoji;
        document.getElementById('study-word').textContent = item.word;
        document.getElementById('study-trans').textContent = item.trans;

        const btn = document.getElementById('study-next-btn');
        if (currentIndex === stageWords.length - 1) {
            btn.textContent = "å»æµ‹éªŒæŒ‘æˆ˜ï¼";
            btn.style.backgroundColor = "var(--primary-color)";
        } else {
            btn.textContent = "ä¸‹ä¸€ä¸ª";
            btn.style.backgroundColor = "var(--secondary-color)";
        }
        
        // è‡ªåŠ¨å‘éŸ³
        setTimeout(() => speak(item.word), 300);
    }

    function nextStudyCard() {
        if (currentIndex < stageWords.length - 1) {
            currentIndex++;
            loadStudyCard();
        } else {
            startQuiz();
        }
    }

    // æµ‹éªŒé€»è¾‘
    function startQuiz() {
        currentIndex = 0;
        loadQuizQuestion();
        showScreen('quiz-screen');
    }

    function loadQuizQuestion() {
        const item = stageWords[currentIndex];
        document.getElementById('quiz-question').textContent = item.trans;
        
        const progressPct = (currentIndex / stageWords.length) * 100;
        document.getElementById('progress').style.width = `${progressPct}%`;

        // å¹²æ‰°é¡¹é€»è¾‘ï¼šä¼˜å…ˆä»å½“å¤©æœªå‡ºç°çš„è¯åº“ä¸­é€‰ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä»å¤§è¯åº“é€‰
        let options = [item];
        let pool = fullVocabulary.filter(w => w.word !== item.word);
        pool = shuffleArray(pool);
        options = options.concat(pool.slice(0, 2));
        options = shuffleArray(options);

        const container = document.getElementById('quiz-options');
        container.innerHTML = '';

        options.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            btn.innerHTML = `<span style="font-size:1.4rem; vertical-align:middle; margin-right:10px">${opt.emoji}</span> ${opt.word}`;
            btn.onclick = () => checkAnswer(opt, item, btn);
            container.appendChild(btn);
        });
    }

    function checkAnswer(selected, correct, btn) {
        if (selected.word === correct.word) {
            btn.classList.add('correct-anim');
            speak("Good job!");
            confetti({ particleCount: 20, spread: 40, origin: { y: 0.7 } });
            
            setTimeout(() => {
                if (currentIndex < stageWords.length - 1) {
                    currentIndex++;
                    loadQuizQuestion();
                } else {
                    finishStage();
                }
            }, 1000);
        } else {
            btn.classList.add('wrong-anim');
            speak("Try again");
            if(navigator.vibrate) navigator.vibrate(200);
            setTimeout(() => btn.classList.remove('wrong-anim'), 500);
        }
    }

    function finishStage() {
        document.getElementById('progress').style.width = '100%';
        if (currentStage < TOTAL_STAGES) {
            showScreen('level-screen');
            speak("Level Complete!");
        } else {
            showScreen('final-screen');
            speak("All finished! Excellent!");
            fireBigConfetti();
            document.getElementById('stage-indicator').style.display = 'none';
        }
    }

    function nextStage() {
        currentStage++;
        startStage();
    }

    function showScreen(id) {
        document.querySelectorAll('.screen').forEach(el => el.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    }

    function speak(text) {
        const u = new SpeechSynthesisUtterance(text);
        u.lang = 'en-US';
        u.rate = 0.8;
        window.speechSynthesis.speak(u);
    }
    
    function speakCurrentWord() {
        speak(stageWords[currentIndex].word);
    }

    function fireBigConfetti() {
        const duration = 3000;
        const end = Date.now() + duration;
        (function frame() {
            confetti({ particleCount: 5, angle: 60, spread: 55, origin: { x: 0 } });
            confetti({ particleCount: 5, angle: 120, spread: 55, origin: { x: 1 } });
            if (Date.now() < end) requestAnimationFrame(frame);
        }());
    }
</script>
</body>
</html>